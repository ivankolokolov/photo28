{% extends "base.html" %}

{% block title %}–ü—Ä–æ–º–æ–∫–æ–¥—ã ‚Äî Photo28 Admin{% endblock %}

{% block content %}
<h1 style="margin-bottom: 2rem;">üéü –ü—Ä–æ–º–æ–∫–æ–¥—ã</h1>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</h2>
    </div>
    
    <form method="post" action="/promocodes">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label" for="code">–ö–æ–¥*</label>
                <input type="text" id="code" name="code" class="form-input" required placeholder="WELCOME10" style="text-transform: uppercase;">
            </div>
            
            <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label" for="discount_percent">–°–∫–∏–¥–∫–∞ %</label>
                <input type="number" id="discount_percent" name="discount_percent" class="form-input" placeholder="10" min="1" max="100">
            </div>
            
            <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label" for="discount_amount">–ò–ª–∏ —Ñ–∏–∫—Å. —Å—É–º–º–∞ ‚ÇΩ</label>
                <input type="number" id="discount_amount" name="discount_amount" class="form-input" placeholder="100" min="1">
            </div>
            
            <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label" for="max_uses">–ú–∞–∫—Å. –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π</label>
                <input type="number" id="max_uses" name="max_uses" class="form-input" placeholder="‚àû" min="1">
            </div>
            
            <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label" for="description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                <input type="text" id="description" name="description" class="form-input" placeholder="–î–ª—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤">
            </div>
        </div>
        
        <button type="submit" class="btn btn-primary" style="margin-top: 1rem;">–°–æ–∑–¥–∞—Ç—å</button>
    </form>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">–í—Å–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã</h2>
    </div>
    
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>–ö–æ–¥</th>
                    <th>–°–∫–∏–¥–∫–∞</th>
                    <th>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π</th>
                    <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–°–æ–∑–¥–∞–Ω</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for promo in promocodes %}
                <tr>
                    <td><strong>{{ promo.code }}</strong></td>
                    <td>
                        {% if promo.discount_percent %}
                        {{ promo.discount_percent }}%
                        {% elif promo.discount_amount %}
                        {{ promo.discount_amount }}‚ÇΩ
                        {% endif %}
                    </td>
                    <td>
                        {{ promo.current_uses }}{% if promo.max_uses %} / {{ promo.max_uses }}{% endif %}
                    </td>
                    <td>{{ promo.description or '‚Äî' }}</td>
                    <td>
                        {% if promo.is_active %}
                        <span class="badge badge-paid">–ê–∫—Ç–∏–≤–µ–Ω</span>
                        {% else %}
                        <span class="badge badge-cancelled">–ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span>
                        {% endif %}
                    </td>
                    <td>{{ promo.created_at.strftime('%d.%m.%Y') }}</td>
                    <td style="white-space: nowrap;">
                        <form method="post" action="/promocodes/{{ promo.id }}/toggle" style="display: inline;">
                            <button type="submit" class="btn btn-sm" title="{% if promo.is_active %}–û—Ç–∫–ª—é—á–∏—Ç—å{% else %}–í–∫–ª—é—á–∏—Ç—å{% endif %}">
                                {% if promo.is_active %}‚è∏{% else %}‚ñ∂{% endif %}
                            </button>
                        </form>
                        <form method="post" action="/promocodes/{{ promo.id }}/delete" style="display: inline;" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ {{ promo.code }}?')">
                            <button type="submit" class="btn btn-sm btn-danger" title="–£–¥–∞–ª–∏—Ç—å">üóë</button>
                        </form>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="7" style="text-align: center; color: var(--text-muted);">
                        –ü—Ä–æ–º–æ–∫–æ–¥–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

